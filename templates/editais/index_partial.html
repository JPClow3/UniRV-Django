{% load static %}
<!-- Partial template for AJAX requests - contains only the grid and pagination -->
{% if page_obj and page_obj.object_list %}
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 min-h-[400px] editais-grid">
    {% for edital in page_obj %}
      <a href="{{ edital.get_absolute_url }}" class="edital-card bg-white rounded-3xl p-8 h-full flex flex-col cursor-pointer no-underline shadow-xl hover:shadow-xl transition-all duration-300 border border-gray-200 overflow-hidden group transform hover:-translate-y-2" aria-label="Ver detalhes do edital {{ edital.titulo }}">
        <!-- Status Badge -->
        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide mb-6 w-fit {% if edital.status == 'aberto' %}bg-green-100 text-green-700{% elif edital.status == 'fechado' %}bg-gray-100 text-gray-600{% else %}bg-blue-100 text-blue-700{% endif %}">
          <i class="fas {% if edital.status == 'aberto' %}fa-check-circle{% elif edital.status == 'fechado' %}fa-times-circle{% else %}fa-hourglass-half{% endif %} mr-1.5"></i>
          {{ edital.get_status_display }}
        </span>
        
        <!-- Icon Area & Type Badge -->
        <div class="flex items-start justify-between mb-4">
        <div class="w-14 h-14 rounded-xl bg-gradient-to-br 
            {% if edital.end_date %}from-blue-50 to-indigo-100 border border-blue-100
            {% else %}from-blue-50 to-primary-hover/20 border border-blue-100{% endif %}
            flex items-center justify-center text-lg border shadow-inner group-hover:scale-110 transition-transform duration-300 shrink-0" style="image-rendering: -webkit-optimize-contrast; image-rendering: crisp-edges;">
            {% if edital.end_date %}
              <i class="fas fa-money-bill-wave {% if edital.end_date %}text-blue-600{% endif %}" style="text-rendering: optimizeLegibility; -webkit-font-smoothing: antialiased;"></i>
            {% else %}
              <i class="fas fa-sync-alt text-primary-hover" style="text-rendering: optimizeLegibility; -webkit-font-smoothing: antialiased;"></i>
            {% endif %}
          </div>
          {% if edital.numero_edital %}
          <span class="inline-flex items-center px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-bold uppercase tracking-wide ml-2 shrink-0">
            Edital {{ edital.numero_edital }}
          </span>
          {% endif %}
        </div>
        
        <!-- Content -->
        <div class="mb-6 grow">
          <h3 class="font-extrabold text-2xl text-gray-900 group-hover:text-primary transition-colors mb-3 leading-tight">{{ edital.titulo }}</h3>
          <p class="text-xs font-bold 
            {% if edital.end_date %}text-blue-600
            {% else %}text-purple-600{% endif %}
            uppercase tracking-wider mb-4">
            {% if edital.end_date %}
              <i class="fas fa-hand-holding-usd mr-1.5"></i>Fomento
            {% else %}
              <i class="fas fa-infinity mr-1.5"></i>Fluxo Contínuo
            {% endif %}
          </p>
          <p class="text-gray-600 text-sm leading-relaxed line-clamp-3">
            {{ edital.objetivo|default:edital.analise|default:"Sem descrição disponível."|striptags|truncatewords:25 }}
          </p>
        </div>

        <!-- Footer Info -->
        <div class="flex flex-wrap gap-x-6 gap-y-2 text-xs text-gray-500 border-t border-gray-100 pt-4 mt-auto">
          {% if edital.start_date %}
            <div class="flex items-center gap-2">
              <i class="fas fa-calendar-alt text-secondary"></i>
              <span>Abertura: <span class="font-medium text-gray-900">{{ edital.start_date|date:"d/m/Y" }}</span></span>
            </div>
          {% endif %}
          {% if edital.end_date %}
            <div class="flex items-center gap-2">
              <i class="fas fa-clock text-orange-500"></i>
              <span>Encerramento: <span class="font-medium text-gray-900">{{ edital.end_date|date:"d/m/Y" }}</span></span>
            </div>
          {% endif %}
        </div>
      </a>
    {% endfor %}
  </div>

  <!-- Pagination -->
  {% if page_obj.has_other_pages %}
    <div class="pagination-container mt-12 flex justify-center">
      <nav class="flex items-center gap-2" aria-label="Pagination">
        {% if page_obj.has_previous %}
          <a href="?page={{ page_obj.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if status_filter %}&status={{ status_filter }}{% endif %}{% if orgao_filter %}&orgao={{ orgao_filter }}{% endif %}{% if start_date_filter %}&start_date={{ start_date_filter }}{% endif %}{% if end_date_filter %}&end_date={{ end_date_filter }}{% endif %}{% if only_open %}&only_open=1{% endif %}" class="page-link px-4 py-3 rounded-xl border border-gray-300 bg-white text-gray-500 hover:bg-gray-50 hover:text-gray-700 transition-all duration-300 transform hover:-translate-y-0.5 shadow-sm hover:shadow min-w-[44px] min-h-[44px] inline-flex items-center justify-center">
            <span class="sr-only">Anterior</span>
            <i class="fas fa-chevron-left"></i>
          </a>
        {% endif %}
        
        <span class="px-4 py-2 text-sm font-medium text-gray-700">
          Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}
        </span>
        
        {% if page_obj.has_next %}
          <a href="?page={{ page_obj.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if status_filter %}&status={{ status_filter }}{% endif %}{% if tipo_filter %}&tipo={{ tipo_filter }}{% endif %}" class="page-link px-4 py-3 rounded-xl border border-gray-300 bg-white text-gray-500 hover:bg-gray-50 hover:text-gray-700 transition-all duration-300 transform hover:-translate-y-0.5 shadow-sm hover:shadow min-w-[44px] min-h-[44px] inline-flex items-center justify-center">
            <span class="sr-only">Próxima</span>
            <i class="fas fa-chevron-right"></i>
          </a>
        {% endif %}
      </nav>
    </div>
  {% endif %}

{% else %}
  <!-- Empty State -->
  {% if search_query or status_filter or orgao_filter or start_date_filter or end_date_filter or only_open %}
    <div id="no-results" class="text-center py-20 max-w-lg mx-auto">
      <!-- Search illustration -->
      <div class="empty-state-illustration mb-6 flex justify-center">
        <svg class="w-28 h-28 md:w-32 md:h-32" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <circle cx="85" cy="85" r="45" fill="white" stroke="#2563EB" stroke-width="4"/>
          <circle cx="85" cy="85" r="35" fill="#F3F4F6"/>
          <path d="M65 65C75 55 95 55 95 65" stroke="white" stroke-width="4" stroke-linecap="round" opacity="0.8"/>
          <line x1="120" y1="120" x2="160" y2="160" stroke="#2563EB" stroke-width="8" stroke-linecap="round"/>
          <text x="85" y="95" text-anchor="middle" fill="#9CA3AF" font-size="30" font-weight="bold">?</text>
          <circle cx="45" cy="150" r="6" fill="#22c55e" opacity="0.3"/>
          <circle cx="155" cy="50" r="8" fill="#2563EB" opacity="0.2"/>
          <circle cx="170" cy="100" r="4" fill="#22c55e" opacity="0.4"/>
        </svg>
      </div>
      <h2 class="text-gray-900 font-bold text-xl mb-2">Nenhum edital encontrado</h2>
      
      {% if search_query %}
        <p class="text-gray-600 mb-6">
          Não encontramos editais para "<strong>{{ search_query }}</strong>".
        </p>
        
        {% if search_suggestions %}
          <div class="mb-6">
            <p class="text-sm text-gray-600 mb-3 font-medium">Você quis dizer:</p>
            <div class="flex flex-wrap gap-2 justify-center">
              {% for suggestion in search_suggestions %}
                <a href="?search={{ suggestion|urlencode }}" 
                   class="px-4 py-2 bg-blue-50 border border-blue-200 rounded-lg text-blue-700 hover:bg-blue-100 hover:border-blue-300 transition-colors font-medium text-sm">
                  {{ suggestion }}
                </a>
              {% endfor %}
            </div>
          </div>
        {% else %}
          <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6 text-left">
            <h3 class="font-semibold text-blue-900 mb-2">Dicas de busca:</h3>
            <ul class="text-sm text-blue-800 space-y-1">
              <li>• Verifique a ortografia das palavras</li>
              <li>• Tente termos mais genéricos (ex: "agricultura" em vez de "agropecuária")</li>
              <li>• Use palavras-chave diferentes</li>
              <li>• Remova filtros para ampliar os resultados</li>
            </ul>
          </div>
        {% endif %}
      {% elif status_filter %}
        <p class="text-gray-600 mb-6">
          Não há editais com status <strong>{{ status_filter|title }}</strong> no momento.
        </p>
      {% elif orgao_filter %}
        <p class="text-gray-600 mb-6">
          Não há editais do orgão <strong>{{ orgao_filter }}</strong> no momento.
        </p>
      {% elif start_date_filter or end_date_filter %}
        <p class="text-gray-600 mb-6">
          Não há editais no período selecionado.
        </p>
      {% elif only_open %}
        <p class="text-gray-600 mb-6">
          Não há editais abertos no momento.
        </p>
      {% endif %}
      
      <div class="flex flex-col sm:flex-row gap-3 justify-center">
        <a href="{% url 'editais_index' %}" class="inline-flex items-center justify-center gap-2 px-8 py-4 bg-primary text-white font-bold rounded-xl hover:bg-blue-700 transition-colors shadow-lg hover:shadow-xl text-base min-h-[48px]">
          <i class="fas fa-redo"></i> Limpar Filtros
        </a>
        <a href="mailto:ypetec@unirv.edu.br" class="inline-flex items-center justify-center gap-2 px-6 py-3 bg-white border-2 border-gray-300 text-gray-700 font-medium rounded-full hover:border-primary hover:text-primary transition-colors min-h-[44px]">
          <i class="fas fa-envelope"></i> Receber Notificações
        </a>
      </div>
    </div>
  {% else %}
    {% include 'components/empty_state.html' with icon='fa-file-alt' title='Nenhum edital disponível no momento' description='Novos editais serão publicados em breve. Fique atento às oportunidades!' illustration='documents' %}
  {% endif %}
{% endif %}

