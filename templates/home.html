{% extends 'base.html' %}
{% load static %}

{% block title %}AgroHub UniRV - Inovação e Tecnologia{% endblock %}

{% block extra_head %}
<link rel="preload" as="image" href="{% static 'img/agrohub-hero.webp' %}" fetchpriority="high">
<style>
    /* Custom Styles para Profundidade e GSAP */
    .glass-card {
        background: rgba(255, 255, 255, 0.7);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.5);
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.07);
    }
    
    .text-gradient {
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-image: linear-gradient(to right, var(--color-unirvBlue), var(--color-agrohubBlue));
    }

    /* Timeline Line */
    .timeline-line {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        width: 2px;
        height: 100%;
        background-color: #e5e7eb;
        z-index: 0;
    }
    
    .timeline-progress {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        width: 2px;
        height: 0%;
        background: linear-gradient(to bottom, #10b981, #059669);
        z-index: 1;
        transition: height 0.5s ease;
    }

    /* ALL elements are visible by default - no CSS hiding */
    /* Elements start in their natural visible state */
    /* GSAP will animate them when it loads - if GSAP doesn't load, they stay visible */
</style>
{% endblock %}

{% block content %}
<div class="overflow-x-hidden">

  <section class="relative min-h-[90vh] flex items-center justify-center overflow-hidden" aria-label="Seção principal">
    <div class="absolute inset-0 z-0">
        <img src="{% static 'img/agrohub-hero.webp' %}" alt="Background" class="w-full h-full object-cover object-center scale-105" id="hero-bg">
        <div class="absolute inset-0 bg-gradient-to-r from-unirvBlue/95 via-unirvBlue/80 to-transparent"></div>
    </div>

    <div class="absolute inset-0 overflow-hidden pointer-events-none z-0">
        <div class="absolute top-20 right-20 w-96 h-96 bg-blue-500/20 rounded-full blur-3xl mix-blend-screen animate-pulse"></div>
        <div class="absolute bottom-20 left-20 w-72 h-72 bg-green-500/20 rounded-full blur-3xl mix-blend-screen"></div>
    </div>

    <div class="container relative z-10 mx-auto px-4 sm:px-6 lg:px-8 pt-20">
      <div class="max-w-4xl">
        <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white/10 border border-white/20 backdrop-blur-sm text-white mb-6 gsap-fade-up">
            <span class="w-2 h-2 rounded-full bg-green-400 animate-pulse"></span>
            <span class="text-sm font-medium tracking-wide uppercase">Ecossistema de Inovação</span>
        </div>
        
        <h1 class="text-white mb-6 text-5xl md:text-6xl lg:text-7xl leading-tight font-extrabold tracking-tight gsap-fade-up">
          O Futuro do Agro <br>
          <span class="text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-blue-400">Começa Aqui.</span>
        </h1>
        
        <p class="text-lg md:text-xl text-gray-200 mb-10 leading-relaxed max-w-2xl gsap-fade-up">
          O AgroHub UniRV conecta academia, startups e o setor produtivo. Aceleramos a transformação digital (IA, IoT) e posicionamos Rio Verde como referência global.
        </p>
        
        <div class="flex flex-col sm:flex-row gap-4 gsap-fade-up">
          <a href="{% url 'editais_index' %}" class="group relative inline-flex items-center justify-center px-8 py-4 text-base font-bold text-white bg-green-600 rounded-full overflow-hidden transition-all duration-300 hover:bg-green-700 shadow-lg hover:shadow-green-500/30 hover:-translate-y-1">
            <span class="relative z-10 flex items-center gap-2">
                Ver Editais Abertos <i class="fas fa-arrow-right group-hover:translate-x-1 transition-transform"></i>
            </span>
          </a>
          <a href="{% url 'ambientes_inovacao' %}" class="inline-flex items-center justify-center px-8 py-4 border border-white/30 backdrop-blur-md text-base font-medium rounded-full text-white hover:bg-white/10 transition-all duration-300">
            Conhecer Infraestrutura
          </a>
        </div>
      </div>
    </div>
  </section>

  <section class="relative z-20 -mt-20 px-4 sm:px-6 lg:px-8">
    <div class="container mx-auto">
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6 bg-white/90 backdrop-blur-xl rounded-3xl shadow-2xl p-6 md:p-10 border border-white/50">
        
        <div class="text-center md:text-left md:border-r border-gray-100 last:border-0 p-4 gsap-stat-item">
          <div class="text-4xl md:text-5xl font-bold text-unirvBlue mb-2 flex justify-center md:justify-start items-baseline">
            <span class="counter" data-target="3">0</span>
          </div>
          <p class="text-sm text-gray-500 font-medium uppercase tracking-wider">Fases de Expansão</p>
        </div>

        <div class="text-center md:text-left md:border-r border-gray-100 last:border-0 p-4 gsap-stat-item">
          <div class="text-4xl md:text-5xl font-bold text-unirvBlue mb-2 flex justify-center md:justify-start items-baseline">
            <span class="counter" data-target="12">0</span><span>+</span>
          </div>
          <p class="text-sm text-gray-500 font-medium uppercase tracking-wider">Startups Incubadas</p>
        </div>

        <div class="text-center md:text-left md:border-r border-gray-100 last:border-0 p-4 gsap-stat-item">
          <div class="text-4xl md:text-5xl font-bold text-unirvBlue mb-2 flex justify-center md:justify-start items-baseline">
            <span class="counter" data-target="40">0</span><span>ha</span>
          </div>
          <p class="text-sm text-gray-500 font-medium uppercase tracking-wider">Smart Farm</p>
        </div>

        <div class="text-center md:text-left p-4 gsap-stat-item">
          <div class="text-4xl md:text-5xl font-bold text-unirvBlue mb-2 flex justify-center md:justify-start items-baseline">
            <span>R$</span><span class="counter" data-target="10">0</span><span>M+</span>
          </div>
          <p class="text-sm text-gray-500 font-medium uppercase tracking-wider">Investimento</p>
        </div>

      </div>
    </div>
  </section>

  <section class="py-24 md:py-32 bg-gray-50 relative overflow-hidden">
    <div class="absolute top-0 left-0 w-full h-full overflow-hidden opacity-30 pointer-events-none">
        <div class="absolute -top-24 -right-24 w-96 h-96 bg-blue-200 rounded-full blur-3xl"></div>
        <div class="absolute top-1/2 -left-24 w-72 h-72 bg-green-200 rounded-full blur-3xl"></div>
    </div>

    <div class="container mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
      <div class="text-center max-w-3xl mx-auto mb-20 gsap-fade-up">
        <h2 class="text-unirvBlue text-sm font-bold uppercase tracking-widest mb-3">Nossos Fundamentos</h2>
        <h3 class="text-4xl md:text-5xl font-bold text-gray-900 mb-6">Pilares do AgroHub</h3>
        <p class="text-gray-600 text-lg">
          Os quatro eixos estratégicos que impulsionam a inovação no coração do agronegócio brasileiro.
        </p>
      </div>

      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 lg:gap-8">
        <div class="glass-card p-8 rounded-3xl hover:-translate-y-2 transition-transform duration-500 group gsap-pillar-card">
          <div class="w-14 h-14 bg-blue-100 rounded-2xl flex items-center justify-center mb-6 group-hover:bg-blue-600 transition-colors duration-300">
            <i class="fas fa-flask text-blue-600 group-hover:text-white text-xl transition-colors"></i>
          </div>
          <h4 class="text-xl font-bold text-gray-900 mb-3">Pesquisa & Inovação</h4>
          <p class="text-gray-600 text-sm leading-relaxed">Desenvolvimento de tecnologias aplicadas à agricultura com base científica rigorosa.</p>
        </div>
        
        <div class="glass-card p-8 rounded-3xl hover:-translate-y-2 transition-transform duration-500 group gsap-pillar-card">
          <div class="w-14 h-14 bg-purple-100 rounded-2xl flex items-center justify-center mb-6 group-hover:bg-purple-600 transition-colors duration-300">
            <i class="fas fa-digital-tachograph text-purple-600 group-hover:text-white text-xl transition-colors"></i>
          </div>
          <h4 class="text-xl font-bold text-gray-900 mb-3">Agro 4.0</h4>
          <p class="text-gray-600 text-sm leading-relaxed">IA, IoT e automação conectando dados e sensores para decisões inteligentes no campo.</p>
        </div>
        
        <div class="glass-card p-8 rounded-3xl hover:-translate-y-2 transition-transform duration-500 group gsap-pillar-card">
          <div class="w-14 h-14 bg-green-100 rounded-2xl flex items-center justify-center mb-6 group-hover:bg-green-600 transition-colors duration-300">
            <i class="fas fa-rocket text-green-600 group-hover:text-white text-xl transition-colors"></i>
          </div>
          <h4 class="text-xl font-bold text-gray-900 mb-3">Startups</h4>
          <p class="text-gray-600 text-sm leading-relaxed">Fomento a novos negócios e incubação através da YpeTech para gerar impacto real.</p>
        </div>
        
        <div class="glass-card p-8 rounded-3xl hover:-translate-y-2 transition-transform duration-500 group gsap-pillar-card">
          <div class="w-14 h-14 bg-amber-100 rounded-2xl flex items-center justify-center mb-6 group-hover:bg-amber-600 transition-colors duration-300">
            <i class="fas fa-leaf text-amber-600 group-hover:text-white text-xl transition-colors"></i>
          </div>
          <h4 class="text-xl font-bold text-gray-900 mb-3">Sustentabilidade</h4>
          <p class="text-gray-600 text-sm leading-relaxed">Compromisso com práticas ESG e redução de impacto ambiental na cadeia produtiva.</p>
        </div>
      </div>
    </div>
  </section>

  <section class="py-24 bg-white relative">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex flex-col lg:flex-row items-center gap-16">
        <div class="lg:w-1/2 gsap-fade-right">
            <h2 class="text-4xl font-bold text-gray-900 mb-6">Hélice Quádrupla do <br><span class="text-gradient">Desenvolvimento</span></h2>
            <p class="text-gray-600 text-lg mb-8 leading-relaxed">
                O AgroHub UniRV não atua sozinho. Somos o ponto de convergência entre os quatro atores fundamentais para criar um ecossistema de inovação robusto e sustentável.
            </p>
            
            <div class="space-y-6">
                <div class="flex items-center gap-4 p-4 rounded-xl hover:bg-gray-50 transition-colors border border-transparent hover:border-gray-100">
                    <div class="w-12 h-12 rounded-full bg-blue-600 flex items-center justify-center text-white shadow-lg shadow-blue-200">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div>
                        <h4 class="font-bold text-gray-900">Academia</h4>
                        <p class="text-sm text-gray-500">Pesquisadores, estudantes e laboratórios.</p>
                    </div>
                </div>
                <div class="flex items-center gap-4 p-4 rounded-xl hover:bg-gray-50 transition-colors border border-transparent hover:border-gray-100">
                    <div class="w-12 h-12 rounded-full bg-green-600 flex items-center justify-center text-white shadow-lg shadow-green-200">
                        <i class="fas fa-tractor"></i>
                    </div>
                    <div>
                        <h4 class="font-bold text-gray-900">Setor Produtivo</h4>
                        <p class="text-sm text-gray-500">Produtores rurais, cooperativas e empresas.</p>
                    </div>
                </div>
                <div class="flex items-center gap-4 p-4 rounded-xl hover:bg-gray-50 transition-colors border border-transparent hover:border-gray-100">
                    <div class="w-12 h-12 rounded-full bg-purple-600 flex items-center justify-center text-white shadow-lg shadow-purple-200">
                        <i class="fas fa-landmark"></i>
                    </div>
                    <div>
                        <h4 class="font-bold text-gray-900">Governo</h4>
                        <p class="text-sm text-gray-500">Políticas públicas, FAPEG e FINEP.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="lg:w-1/2 relative gsap-scale-up">
            <div class="relative aspect-square max-w-md mx-auto">
                <div class="absolute inset-0 bg-gradient-to-br from-blue-100 to-green-100 rounded-full animate-pulse blur-3xl opacity-50"></div>
                <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-20">
                    <div class="w-32 h-32 bg-white rounded-full shadow-2xl flex items-center justify-center border-4 border-unirvBlue">
                        <img src="{% static 'img/Logo.svg' %}" alt="Logo" class="w-16">
                    </div>
                </div>
                <div class="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-16 h-16 bg-white rounded-2xl shadow-lg flex items-center justify-center text-blue-600 z-10">
                    <i class="fas fa-university text-2xl"></i>
                </div>
                <div class="absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-1/2 w-16 h-16 bg-white rounded-2xl shadow-lg flex items-center justify-center text-green-600 z-10">
                    <i class="fas fa-leaf text-2xl"></i>
                </div>
                <div class="absolute left-0 top-1/2 transform -translate-x-1/2 -translate-y-1/2 w-16 h-16 bg-white rounded-2xl shadow-lg flex items-center justify-center text-purple-600 z-10">
                    <i class="fas fa-flask text-2xl"></i>
                </div>
                <div class="absolute right-0 top-1/2 transform translate-x-1/2 -translate-y-1/2 w-16 h-16 bg-white rounded-2xl shadow-lg flex items-center justify-center text-amber-600 z-10">
                    <i class="fas fa-users text-2xl"></i>
                </div>
                <div class="absolute inset-4 border-2 border-dashed border-gray-300 rounded-full animate-spin" style="animation-duration: 20s;"></div>
            </div>
        </div>
      </div>
    </div>
  </section>

  <section class="py-24 bg-gray-50 relative">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-20 gsap-fade-up">
        <h2 class="text-unirvBlue text-sm font-bold uppercase tracking-widest mb-3">Cronograma</h2>
        <h3 class="text-4xl md:text-5xl font-bold text-gray-900">Fases de Expansão</h3>
      </div>

      <div class="relative max-w-4xl mx-auto">
        <div class="timeline-line hidden md:block"></div>
        <div class="timeline-progress hidden md:block" id="timeline-bar"></div>

        <div class="space-y-12 md:space-y-24">
            
            <div class="relative flex flex-col md:flex-row items-center md:justify-between group timeline-item">
                <div class="md:w-5/12 order-2 md:order-1 text-center md:text-right pr-0 md:pr-8 mt-4 md:mt-0">
                    <span class="inline-block px-3 py-1 bg-green-100 text-green-700 text-xs font-bold rounded-full mb-2">CONCLUÍDA</span>
                    <h4 class="text-xl font-bold text-gray-900 mb-2">Estruturação Inicial</h4>
                    <p class="text-gray-600 text-sm">Implementação do Centro, Incubadora YpeTech, FabLab e espaços de coworking.</p>
                </div>
                
                <div class="md:w-2/12 order-1 md:order-2 flex justify-center relative z-10">
                    <div class="w-12 h-12 bg-green-600 rounded-full border-4 border-white shadow-lg flex items-center justify-center text-white transition-transform group-hover:scale-110">
                        <i class="fas fa-check"></i>
                    </div>
                </div>
                
                <div class="md:w-5/12 order-3 md:order-3 md:pl-8 hidden md:block"></div>
            </div>

            <div class="relative flex flex-col md:flex-row items-center md:justify-between group timeline-item">
                <div class="md:w-5/12 order-3 md:order-1 hidden md:block"></div>
                
                <div class="md:w-2/12 order-1 md:order-2 flex justify-center relative z-10">
                    <div class="w-14 h-14 bg-white rounded-full border-4 border-amber-400 shadow-lg flex items-center justify-center text-amber-500 transition-transform group-hover:scale-110">
                        <i class="fas fa-spinner fa-spin-pulse"></i>
                    </div>
                </div>
                
                <div class="md:w-5/12 order-2 md:order-3 text-center md:text-left pl-0 md:pl-8 mt-4 md:mt-0">
                    <span class="inline-block px-3 py-1 bg-amber-100 text-amber-700 text-xs font-bold rounded-full mb-2">EM ANDAMENTO</span>
                    <h4 class="text-xl font-bold text-gray-900 mb-2">Smart Farm</h4>
                    <p class="text-gray-600 text-sm">Implementação de tecnologias avançadas, IoT e monitoramento em tempo real nos 16ha irrigados.</p>
                </div>
            </div>

            <div class="relative flex flex-col md:flex-row items-center md:justify-between group timeline-item opacity-60">
                <div class="md:w-5/12 order-2 md:order-1 text-center md:text-right pr-0 md:pr-8 mt-4 md:mt-0">
                    <span class="inline-block px-3 py-1 bg-gray-200 text-gray-600 text-xs font-bold rounded-full mb-2">PLANEJADA</span>
                    <h4 class="text-xl font-bold text-gray-900 mb-2">Condomínio de Empresas</h4>
                    <p class="text-gray-600 text-sm">Expansão física e atração de grandes companhias do setor para instalação no hub.</p>
                </div>
                
                <div class="md:w-2/12 order-1 md:order-2 flex justify-center relative z-10">
                    <div class="w-12 h-12 bg-gray-300 rounded-full border-4 border-white shadow-lg flex items-center justify-center text-gray-500">
                        <span class="font-bold">3</span>
                    </div>
                </div>
                
                <div class="md:w-5/12 order-3 md:order-3 hidden md:block"></div>
            </div>

        </div>
      </div>
    </div>
  </section>


  <section class="relative py-24 w-full full-bleed overflow-hidden bg-unirvBlue">
    <div class="absolute inset-0 bg-gradient-to-br from-unirvBlue via-blue-900 to-black opacity-90"></div>
    <div class="absolute -right-20 -bottom-40 w-[600px] h-[600px] bg-blue-500/20 rounded-full blur-3xl"></div>

    <div class="container relative z-10 mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-white mb-6 text-4xl md:text-5xl font-bold tracking-tight">Pronto para inovar?</h2>
      <p class="text-lg md:text-xl text-blue-100 mb-10 max-w-2xl mx-auto">
        Junte-se ao ecossistema que está definindo o futuro do agronegócio. Acesse editais ou traga sua startup.
      </p>
      
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a href="{% url 'editais_index' %}" class="btn btn-lg bg-white text-unirvBlue hover:bg-blue-50 border-0 px-10 py-4 text-lg rounded-full font-bold shadow-xl transition-transform hover:-translate-y-1">
          Ver Oportunidades
        </a>
        <a href="{% url 'register' %}" class="btn btn-lg bg-transparent border-2 border-white/30 text-white hover:bg-white/10 px-10 py-4 text-lg rounded-full font-bold transition-all">
          Criar Conta
        </a>
      </div>
    </div>
  </section>

</div>
{% endblock %}

{% block extra_js %}
<script>
    // Remove no-js class immediately if JavaScript is enabled
    (function() {
        document.documentElement.classList.remove('no-js');
        document.documentElement.classList.add('js-enabled');
    })();
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

<script>
    (function() {
        // Check if GSAP is loaded, if not, activate fallbacks
        function activateFallbacks() {
            document.body.classList.add('no-gsap');
            const animatedElements = document.querySelectorAll('.gsap-fade-up, .gsap-pillar-card, .gsap-fade-right, .gsap-scale-up, .gsap-stat-item, .timeline-item');
            animatedElements.forEach(el => {
                el.classList.add('gsap-fallback');
            });
        }

        // Wait for GSAP to load with timeout
        let gsapLoadTimeout;
        function initGSAP() {
            if (typeof gsap === 'undefined' || typeof ScrollTrigger === 'undefined') {
                clearTimeout(gsapLoadTimeout);
                gsapLoadTimeout = setTimeout(() => {
                    if (typeof gsap === 'undefined' || typeof ScrollTrigger === 'undefined') {
                        console.warn('GSAP failed to load, activating fallbacks');
                        activateFallbacks();
                        return;
                    }
                }, 2000);
                return false;
            }
            clearTimeout(gsapLoadTimeout);
            return true;
        }

        document.addEventListener("DOMContentLoaded", (event) => {
            // Elements are visible by default - only hide them if GSAP loads successfully
            // Check GSAP availability
            if (!initGSAP()) {
                // GSAP not loaded yet, wait a bit more
                setTimeout(() => {
                    if (typeof gsap === 'undefined' || typeof ScrollTrigger === 'undefined') {
                        activateFallbacks();
                    } else {
                        // GSAP loaded late, proceed with animations
                        setupAnimations();
                    }
                }, 500);
                return;
            }

            setupAnimations();
        });

        function setupAnimations() {
            try {
                // GSAP is loaded, set up animations
                gsap.registerPlugin(ScrollTrigger);
                
                // Hero Animations - Animate immediately on load
                const heroSection = document.querySelector('section[aria-label="Seção principal"]');
                if (heroSection) {
                    const heroElements = heroSection.querySelectorAll(".gsap-fade-up");
                    if (heroElements.length > 0) {
                        // Use from() which sets initial state and animates in one go
                        gsap.from(heroElements, {
                            opacity: 0,
                            y: 30,
                            duration: 1,
                            stagger: 0.2,
                            ease: "power3.out",
                            delay: 0.1,
                            immediateRender: true
                        });
                    }
                }

                // Parallax Background Hero
                const heroBg = document.getElementById("hero-bg");
                if (heroBg) {
                    gsap.to("#hero-bg", {
                        scrollTrigger: {
                            trigger: heroBg.closest('section') || "body",
                            start: "top top",
                            end: "bottom top",
                            scrub: true,
                            invalidateOnRefresh: true
                        },
                        y: 200,
                        ease: "none"
                    });
                }

                // Counter Animation
                const counters = gsap.utils.toArray(".counter");
                if (counters && counters.length > 0) {
                    counters.forEach(counter => {
                        const target = counter.getAttribute("data-target");
                        if (target && counter) {
                            ScrollTrigger.create({
                                trigger: counter.closest('.gsap-stat-item') || counter,
                                start: "top 85%",
                                once: true,
                                onEnter: () => {
                                    const targetValue = parseFloat(target);
                                    const obj = { value: 0 };
                                    gsap.to(obj, {
                                        value: targetValue,
                                        duration: 2,
                                        ease: "power2.out",
                                        onUpdate: () => {
                                            if (targetValue % 1 === 0) {
                                                counter.textContent = Math.round(obj.value);
                                            } else {
                                                counter.textContent = obj.value.toFixed(1);
                                            }
                                        }
                                    });
                                }
                            });
                        }
                    });
                }

                // Stat items fade in - use from() so they only hide when animation triggers
                const statItems = document.querySelectorAll(".gsap-stat-item");
                if (statItems && statItems.length > 0) {
                    gsap.from(statItems, {
                        scrollTrigger: {
                            trigger: statItems[0].closest('section'),
                            start: "top 80%"
                        },
                        opacity: 0,
                        y: 20,
                        duration: 0.6,
                        stagger: 0.1,
                        ease: "power2.out",
                        immediateRender: false
                    });
                }

                // Pillar Cards Stagger
                const pillarCards = document.querySelectorAll(".gsap-pillar-card");
                if (pillarCards && pillarCards.length > 0) {
                    gsap.from(pillarCards, {
                        scrollTrigger: {
                            trigger: pillarCards[0].closest('section'),
                            start: "top 75%"
                        },
                        opacity: 0,
                        y: 50,
                        duration: 0.8,
                        stagger: 0.15,
                        ease: "back.out(1.7)",
                        immediateRender: false
                    });
                }

                // Other sections with gsap-fade-up (non-hero)
                const otherFadeUpElements = document.querySelectorAll("section:not([aria-label='Seção principal']) .gsap-fade-up");
                if (otherFadeUpElements && otherFadeUpElements.length > 0) {
                    otherFadeUpElements.forEach(element => {
                        gsap.from(element, {
                            scrollTrigger: {
                                trigger: element,
                                start: "top 75%"
                            },
                            opacity: 0,
                            y: 30,
                            duration: 0.8,
                            ease: "power2.out",
                            immediateRender: false
                        });
                    });
                }

                // Hélice Quádrupla
                const fadeRightEl = document.querySelector(".gsap-fade-right");
                if (fadeRightEl) {
                    gsap.from(fadeRightEl, {
                        scrollTrigger: {
                            trigger: fadeRightEl,
                            start: "top 75%"
                        },
                        opacity: 0,
                        x: -50,
                        duration: 1,
                        ease: "power2.out",
                        immediateRender: false
                    });
                }

                const scaleUpEl = document.querySelector(".gsap-scale-up");
                if (scaleUpEl) {
                    gsap.from(scaleUpEl, {
                        scrollTrigger: {
                            trigger: scaleUpEl,
                            start: "top 75%"
                        },
                        opacity: 0,
                        scale: 0.8,
                        duration: 1,
                        ease: "elastic.out(1, 0.75)",
                        immediateRender: false
                    });
                }

                // Timeline Progress Bar
                const timelineSection = document.querySelector('section:has(.timeline-line)');
                const timelineBar = document.getElementById("timeline-bar");
                if (timelineSection && timelineBar) {
                    gsap.to(timelineBar, {
                        scrollTrigger: {
                            trigger: timelineSection,
                            start: "top 60%",
                            end: "bottom 60%",
                            scrub: 0.5,
                            invalidateOnRefresh: true
                        },
                        height: "80%",
                        ease: "none"
                    });
                    
                    // Timeline Items Fade In
                    const timelineItems = gsap.utils.toArray(".timeline-item");
                    if (timelineItems && timelineItems.length > 0) {
                        timelineItems.forEach(item => {
                            if (item) {
                                gsap.from(item, {
                                    scrollTrigger: {
                                        trigger: item,
                                        start: "top 80%"
                                    },
                                    opacity: 0,
                                    y: 20,
                                    duration: 0.6,
                                    ease: "power2.out",
                                    immediateRender: false
                                });
                            }
                        });
                    }
                }

                // Refresh ScrollTrigger after all animations are set up
                ScrollTrigger.refresh();

            } catch (error) {
                console.error('GSAP animation error:', error);
                activateFallbacks();
            }
        }

        // Also try to initialize if GSAP loads after DOMContentLoaded
        window.addEventListener('load', function() {
            // If GSAP loaded late and animations haven't been set up yet
            if (typeof gsap !== 'undefined' && typeof ScrollTrigger !== 'undefined' && !document.body.classList.contains('gsap-ready') && !document.body.classList.contains('no-gsap')) {
                clearTimeout(gsapLoadTimeout);
                setupAnimations();
            } else if (typeof gsap === 'undefined' || typeof ScrollTrigger === 'undefined') {
                // GSAP still not loaded after page load, activate fallbacks
                if (!document.body.classList.contains('no-gsap')) {
                    activateFallbacks();
                }
            }
        });
    })();
</script>
{% endblock %}
