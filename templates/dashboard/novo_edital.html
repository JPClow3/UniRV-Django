{% extends 'dashboard/base.html' %}

{% block title %}Novo Edital - Dashboard AgroHub{% endblock %}

{% block content %}
<div class="space-y-6">
  <!-- Header -->
  <div class="flex items-center justify-between">
    <div class="flex items-center gap-4">
      <a href="{% url 'dashboard_editais' %}" class="bg-transparent hover:bg-gray-100 text-gray-700 rounded-lg px-3 py-2 text-sm transition-all inline-flex items-center gap-2">
        <i class="fas fa-arrow-left w-4 h-4"></i>
        Voltar
      </a>
      <div>
        <h1 class="text-gray-900 text-2xl font-semibold">Novo Edital</h1>
        <p class="text-gray-600">
          Configure os detalhes do edital e campos do formulário
        </p>
      </div>
    </div>

    <div class="flex gap-2">
      <button type="button" class="bg-white border-2 border-gray-300 text-gray-700 hover:bg-gray-50 rounded-lg px-4 py-2 text-sm transition-all inline-flex items-center gap-2">
        <i class="fas fa-save w-4 h-4"></i>
        Salvar Rascunho
      </button>
      <button type="submit" form="edital-form" class="size-lg bg-gradient-to-r from-green-500 to-blue-600 hover:from-green-600 hover:to-blue-700 rounded-lg shadow-md hover:shadow-lg transition-all inline-flex items-center justify-center gap-2 px-6 py-2 text-white font-medium">
        <i class="fas fa-paper-plane w-4 h-4"></i>
        Publicar
      </button>
    </div>
  </div>

  <!-- Form Tabs -->
  <form method="POST" id="edital-form" class="bg-white rounded-xl border border-gray-200 p-6 space-y-6">
    {% csrf_token %}
    <div class="border-b border-gray-200">
      <div class="flex gap-4">
        <button type="button" class="tab-btn active px-4 py-2 border-b-2 border-blue-600 text-blue-600 font-medium">Informações Básicas</button>
        <button type="button" class="tab-btn px-4 py-2 text-gray-600 hover:text-gray-900">Formulário</button>
        <button type="button" class="tab-btn px-4 py-2 text-gray-600 hover:text-gray-900">Avaliação</button>
      </div>
    </div>

    <!-- Tab Content: Informações Básicas -->
    <div id="tab-informacoes" class="tab-content space-y-6">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="space-y-2">
          <label for="numero" class="text-sm font-medium text-gray-700">Número do Edital *</label>
          <input type="text" id="numero" name="numero_edital" placeholder="Ex: 001/2024" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
        </div>

        <div class="space-y-2">
          <label for="tipo" class="text-sm font-medium text-gray-700">Status do Edital *</label>
          <select id="tipo" name="status" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            <option value="draft">Rascunho</option>
            <option value="aberto">Aberto</option>
            <option value="em_andamento">Em Andamento</option>
            <option value="fechado">Fechado</option>
            <option value="programado">Programado</option>
          </select>
        </div>
      </div>

      <div class="space-y-2">
        <label for="titulo" class="text-sm font-medium text-gray-700">Título do Edital *</label>
        <input type="text" id="titulo" name="titulo" placeholder="Ex: Edital de Incubação - Tecnologia 2024" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
      </div>

      <div class="space-y-2">
        <label for="descricao" class="text-sm font-medium text-gray-700">Descrição *</label>
        <textarea id="descricao" name="objetivo" placeholder="Descreva os objetivos e requisitos do edital..." rows="4" required class="w-full px-3 py-2 border border-gray-300 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="space-y-2">
          <label for="dataAbertura" class="text-sm font-medium text-gray-700">Data de Abertura *</label>
          <input type="date" id="dataAbertura" name="start_date" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
        </div>

        <div class="space-y-2">
          <label for="dataFechamento" class="text-sm font-medium text-gray-700">Data de Fechamento</label>
          <input type="date" id="dataFechamento" name="end_date" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          <p class="text-xs text-gray-500">Deixe em branco para fluxo contínuo</p>
        </div>
      </div>
    </div>

    <!-- Tab Content: Formulário -->
    <div id="tab-formulario" class="tab-content space-y-6 hidden">
      <p class="text-gray-600">Conteúdo do formulário será adicionado aqui.</p>
    </div>

    <!-- Tab Content: Avaliação -->
    <div id="tab-avaliacao" class="tab-content space-y-6 hidden">
      <p class="text-gray-600">Conteúdo da avaliação será adicionado aqui.</p>
    </div>
  </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
  const tabs = document.querySelectorAll('.tab-btn');
  const contents = document.querySelectorAll('.tab-content');

  // Helper to show specific tab
  function activateTab(index) {
    // Reset buttons
    tabs.forEach(btn => {
      btn.classList.remove('active', 'border-b-2', 'border-blue-600', 'text-blue-600');
      btn.classList.add('text-gray-600');
    });
    
    // Hide all contents
    contents.forEach(content => content.classList.add('hidden'));

    // Activate clicked button
    // Ensure the clicked element exists before accessing classList
    if(tabs[index]) {
        tabs[index].classList.add('active', 'border-b-2', 'border-blue-600', 'text-blue-600');
        tabs[index].classList.remove('text-gray-600');
    }
    
    // Show content
    if(contents[index]) {
        contents[index].classList.remove('hidden');
    }
  }

  tabs.forEach((btn, index) => {
    btn.addEventListener('click', (e) => {
        e.preventDefault(); // Prevent form submission if button is inside form
        activateTab(index);
    });
  });

  // Show first tab by default
  if (contents.length > 0) {
    activateTab(0);
  }
});
</script>
{% endblock %}

